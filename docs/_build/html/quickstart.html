<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick start! &mdash; HydroCNHS  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Model builder" href="model_builder.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> HydroCNHS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick start!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#run-a-simulation">Run a simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#daily-weather-time-series">Daily weather time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-yaml">Model.yaml</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#path">1. Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#watersystem">2. WaterSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lsm">3. LSM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#routing">1. Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abm-optional">5. ABM (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#systemparseddata-auto-generated">1. SystemParsedData (auto-generated)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#abm-module-s">ABM module(s)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_builder.html">Model builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_build_abm.html">How to build a ABM module?</a></li>
<li class="toctree-l1"><a class="reference internal" href="calibration.html">Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="source/HydroCNHS.html">HydroCNHS package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HydroCNHS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Quick start!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="quick-start">
<h1>Quick start!<a class="headerlink" href="#quick-start" title="Permalink to this headline"></a></h1>
<p>Let’s start with running a simulation using the Tualatin River Basin (TRB) example!</p>
<p>The TRB tutorial codes are located at <strong>./HydroCNHS/tutorials/Tualatin River Basin/</strong></p>
<figure class="align-center" id="id1">
<span id="trb"></span><a class="reference internal image-reference" href="_images/TRB.png"><img alt="The Tualatin River Basin system diagram." src="_images/TRB.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The Tualatin River Basin system diagram (Lin et al., 2022). TRTR,
Hagg<sub>In</sub>, DLLO, TRGC, DAIRY, RCTV, and WSLO are seven subbasins.
PipeAgt, ResAgt, and DivAgt are trans-basin aqueduct, Hagg reservoir, and
irrigation diversion agents, respectively. DrainAgt1 and DrainAgt2 are two drainage system
agents for the runoff-changing scenario.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The TRB, consisting of 1844.07 km2 in northwest Oregon, US, is covered by
densely populated area (20%), agricultural area (30%), and forest (50%)
(Tualatin River Watershed Council, 2021). Its agriculture heavily relies on
irrigation because seasonal rainfall concentrates in winter (November -
February). The Spring Hill Pumping Plant is the largest diversion facility in
the TRB for irrigating Tualatin Valley Irrigation District (TVID; DivAgt),
where the Hagg reservoir (ResAgt) is the primary water source. During the
summer period, water is transferred from the Barney reservoir (outside of the
TRB) through a trans-basin aqueduct (PipeAgt) to augment the low flow for
ecological purposes.</p>
<p>The full background of the TRB can be found in Lin et al., (2022).</p>
<section id="run-a-simulation">
<h2>Run a simulation<a class="headerlink" href="#run-a-simulation" title="Permalink to this headline"></a></h2>
<p>Assuming we have already calibrated the TRB model, let’s take one minute to
browse through the following simulation code. Then, you should be able run the
script directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">HydroCNHS</span>

<span class="c1">##### Setup Working Directory</span>
<span class="c1"># Get this .py file&#39;s directory.</span>
<span class="n">prj_path</span><span class="p">,</span> <span class="n">this_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">wd</span> <span class="o">=</span> <span class="n">prj_path</span>

<span class="c1">##### Load Daily Weather Time Series.</span>
<span class="c1"># We store all required time series data in the pickle format.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prj_path</span><span class="p">,</span> <span class="s2">&quot;Inputs&quot;</span><span class="p">,</span> <span class="s2">&quot;TRB_inputs.pickle&quot;</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">pet</span><span class="p">,</span> <span class="n">obv_D</span><span class="p">,</span> <span class="n">obv_M</span><span class="p">,</span> <span class="n">obv_Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="c1">##### Load Model.yaml.</span>
<span class="n">best_gwlf_abm_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prj_path</span><span class="p">,</span> <span class="s2">&quot;Calibrated_model&quot;</span><span class="p">,</span> <span class="s2">&quot;Best_gwlf_abm_KGE.yaml&quot;</span><span class="p">)</span>
<span class="n">model_dict_gwlf</span> <span class="o">=</span> <span class="n">HydroCNHS</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">best_gwlf_abm_path</span><span class="p">)</span>
<span class="c1"># Change the path according to this .py file&#39;s directory.</span>
<span class="n">model_dict_gwlf</span><span class="p">[</span><span class="s2">&quot;Path&quot;</span><span class="p">][</span><span class="s2">&quot;WD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wd</span>
<span class="n">model_dict_gwlf</span><span class="p">[</span><span class="s2">&quot;Path&quot;</span><span class="p">][</span><span class="s2">&quot;Modules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prj_path</span><span class="p">,</span> <span class="s2">&quot;ABM_modules&quot;</span><span class="p">)</span>

<span class="c1">##### Create HydroCNHS Model Object for Simulation.</span>
<span class="n">model_gwlf</span> <span class="o">=</span> <span class="n">HydroCNHS</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">model_dict_gwlf</span><span class="p">)</span>

<span class="c1">##### Run a simulation</span>
<span class="n">Q_gwlf</span> <span class="o">=</span> <span class="n">model_gwlf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">pet</span><span class="p">)</span> <span class="c1"># pet is optional.</span>
</pre></div>
</div>
<p>To run a coupled natural human model simulation, three items are required.</p>
<ol class="arabic simple">
<li><p>Daily weather time series including temperture (temp) and precipitation (prec). Potential evapotranspiration (pet) is optional.</p></li>
<li><p>Model file (e.g., Best_gwlf_abm_KGE.yaml).</p></li>
<li><p>User-provided ABM module(s) (e.g., TRB_ABM_dm.py). This is not required for pure hydrological model, non-coupled model.</p></li>
</ol>
<p>Now, we are going to introduce these three items in a more detail.</p>
</section>
<section id="daily-weather-time-series">
<h2>Daily weather time series<a class="headerlink" href="#daily-weather-time-series" title="Permalink to this headline"></a></h2>
<p>Temperture and precipitation are two required weather inputs for the
simulation. If potential evapotranspiration is not provided, HydroCNHS will
automatically calculate it by Hamon method. The weather inputs are in a
dictionary format shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;DAIRY&#39;, &#39;DLLO&#39;, &#39;RCTV&#39;, &#39;SCOO&#39;, &#39;TRGC&#39;, &#39;TRTR&#39;, and &#39;WSLO&#39; are subbasins&#39; names.</span>
<span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DAIRY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">7.7</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">6.6</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;DLLO&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">7.9</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;RCTV&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;SCOO&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.1</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;TRGC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.7</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;TRTR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">7.9</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="o">.......</span><span class="p">],</span>
        <span class="s1">&#39;WSLO&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">7.8</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">,</span> <span class="o">.......</span><span class="p">]}</span>
<span class="c1"># Similar to prep and pet.</span>
</pre></div>
</div>
<p>The dictionary will contain weather time series (i.e., a list) for each
subbasin. The length of each time series has to be identical.</p>
</section>
<section id="model-yaml">
<h2>Model.yaml<a class="headerlink" href="#model-yaml" title="Permalink to this headline"></a></h2>
<p>The model file (.yaml) contains settings for hydrological model (e.g.,
rainfall-runoff and routing) and ABM model (e.g., how to coupled).
The model file has six sections:</p>
<section id="path">
<h3>1. Path<a class="headerlink" href="#path" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path for working directory (outputing log file) and user-provided ABM</span>
<span class="c1"># modules (optional).</span>
<span class="nt">Path</span><span class="p">:</span> <span class="p p-Indicator">{</span>
<span class="nt">  WD</span><span class="p">:</span> <span class="s">&#39;wd</span><span class="nv"> </span><span class="s">path&#39;</span><span class="p p-Indicator">,</span>
<span class="nt">  Modules</span><span class="p">:</span> <span class="s">&#39;ABM</span><span class="nv"> </span><span class="s">module</span><span class="nv"> </span><span class="s">path&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
<section id="watersystem">
<h3>2. WaterSystem<a class="headerlink" href="#watersystem" title="Permalink to this headline"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">WaterSystem</span><span class="p">:</span>
        <span class="nt">StartDate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1981/1/1</span>
        <span class="nt">EndDate</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2013/12/31</span>
        <span class="nt">NumSubbasins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">7</span>
        <span class="nt">NumGauges</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
        <span class="nt">NumAgents</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3</span>
        <span class="nt">Outlets</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">TRTR</span><span class="p p-Indicator">,</span> <span class="nv">HaggIn</span><span class="p p-Indicator">,</span> <span class="nv">DLLO</span><span class="p p-Indicator">,</span> <span class="nv">TRGC</span><span class="p p-Indicator">,</span> <span class="nv">DAIRY</span><span class="p p-Indicator">,</span> <span class="nv">RCTV</span><span class="p p-Indicator">,</span> <span class="nv">WSLO</span><span class="p p-Indicator">]</span>
        <span class="nt">GaugedOutlets</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">DLLO</span><span class="p p-Indicator">,</span> <span class="nv">WSLO</span><span class="p p-Indicator">]</span>             <span class="c1"># Optional</span>
        <span class="nt">DataLength</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">12053</span>
</pre></div>
</div>
<p>DataLength can be automatically calculated if EndDate is provided, vice versa.</p>
</section>
<section id="lsm">
<h3>3. LSM<a class="headerlink" href="#lsm" title="Permalink to this headline"></a></h3>
<p>HydroCNHS provides user two rainfall-runoff simulation options, General
Water Loading Function (GWLF; 9 parameters) and ABCD (5 parameters). Their
settings are shown below.</p>
<p>The detailed documentation for GWLF and ABCD can be found at the supplementary
material of (Lin et al., 2022).</p>
<p><strong>GWLF:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">LSM</span><span class="p">:</span>
        <span class="nt">Model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GWLF</span>
        <span class="nt">TRTR</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">329.80</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.45</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">97.148</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.404</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.178</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.482</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.868</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.708</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">14.341</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.124</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">0.988</span><span class="p p-Indicator">}</span>
        <span class="nt">HaggIn</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">10034.24</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.46</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">36.984</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.178</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.122</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.178</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.235</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.112</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">13.932</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.588</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">0.765</span><span class="p p-Indicator">}</span>
        <span class="nt">DLLO</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">22238.43</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.47</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">98.249</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.369</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.281</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.117</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.909</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.381</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">9.0</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.947</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">1.057</span><span class="p p-Indicator">}</span>
        <span class="nt">TRGC</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">24044.63</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.50</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">89.963</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.098</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.047</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.418</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.535</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.115</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">9.107</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.727</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">1.013</span><span class="p p-Indicator">}</span>
        <span class="nt">DAIRY</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">59822.75</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.52</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">95.962</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.026</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.241</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.199</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.432</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.299</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">4.049</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.034</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">1.012</span><span class="p p-Indicator">}</span>
        <span class="nt">RCTV</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">19682.60</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.50</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">93.049</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.341</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.319</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.05</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.316</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.7</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">11.288</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.741</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">0.746</span><span class="p p-Indicator">}</span>
        <span class="nt">WSLO</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">47646.84</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.35</span><span class="p p-Indicator">,</span><span class="nt"> S0</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> U0</span><span class="p">:</span> <span class="nv">10.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">CN2</span><span class="p">:</span> <span class="nv">63.818</span><span class="p p-Indicator">,</span><span class="nt"> IS</span><span class="p">:</span> <span class="nv">0.039</span><span class="p p-Indicator">,</span><span class="nt"> Res</span><span class="p">:</span> <span class="nv">0.305</span><span class="p p-Indicator">,</span><span class="nt"> Sep</span><span class="p">:</span> <span class="nv">0.045</span><span class="p p-Indicator">,</span><span class="nt"> Alpha</span><span class="p">:</span> <span class="nv">0.207</span><span class="p p-Indicator">,</span><span class="nt"> Beta</span><span class="p">:</span> <span class="nv">0.496</span><span class="p p-Indicator">,</span>
<span class="nt">                Ur</span><span class="p">:</span> <span class="nv">13.919</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.175</span><span class="p p-Indicator">,</span><span class="nt"> Kc</span><span class="p">:</span> <span class="nv">1.451</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p><strong>ABCD:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">LSM</span><span class="p">:</span>
        <span class="nt">Model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ABCD</span>
        <span class="nt">TRTR</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">329.80</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.45</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.998</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">53.403</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.345</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.559</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.636</span><span class="p p-Indicator">}</span>
        <span class="nt">HaggIn</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">10034.24</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.46</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.196</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">2.316</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.78</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.248</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.697</span><span class="p p-Indicator">}</span>
        <span class="nt">DLLO</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">22238.43</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.47</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.237</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">16.746</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.693</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.834</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.16</span><span class="p p-Indicator">}</span>
        <span class="nt">TRGC</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">24044.63</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.50</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.306</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">91.475</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.695</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.263</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.727</span><span class="p p-Indicator">}</span>
        <span class="nt">DAIRY</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">59822.75</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.52</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.836</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">5.536</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.795</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.491</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.515</span><span class="p p-Indicator">}</span>
        <span class="nt">RCTV</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">19682.60</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.50</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.516</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">6.632</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.971</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.148</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.681</span><span class="p p-Indicator">}</span>
        <span class="nt">WSLO</span><span class="p">:</span>
                <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">Area</span><span class="p">:</span> <span class="nv">47646.84</span><span class="p p-Indicator">,</span><span class="nt"> Latitude</span><span class="p">:</span> <span class="nv">45.35</span><span class="p p-Indicator">,</span><span class="nt"> XL</span><span class="p">:</span> <span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="nt"> SnowS</span><span class="p">:</span> <span class="nv">5.0</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">0.777</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">307.23</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.453</span><span class="p p-Indicator">,</span><span class="nt"> d</span><span class="p">:</span> <span class="nv">0.638</span><span class="p p-Indicator">,</span><span class="nt"> Df</span><span class="p">:</span> <span class="nv">0.159</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
<section id="routing">
<h3>1. Routing<a class="headerlink" href="#routing" title="Permalink to this headline"></a></h3>
<p>HydroCNHS adopts Lohmann routing model to simulate within-subbasin routing and
inter-subbasin routing process. We adpot a nested struture to setup the routing
setting for each routing outlets (<a class="reference internal" href="#trb"><span class="std std-numref">Fig. 1</span></a>), as shown below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">Routing</span><span class="p">:</span>
        <span class="nt">Model</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Lohmann</span>
        <span class="c1"># WSLO, TRGC, DLLO, and HaggIn are four routing outlets.</span>
        <span class="nt">WSLO</span><span class="p">:</span>
                <span class="c1"># TRGC is a routing outlet. No within-subbasin routing at here (at</span>
                <span class="c1"># its own routing setting below). Namely, TRGC will be routed</span>
                <span class="c1"># first. Therefore, GShape and GScale are null.</span>
                <span class="nt">TRGC</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">80064.86</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">29.84</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">2840.985</span><span class="p p-Indicator">}</span>
                <span class="nt">DAIRY</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">70988.16</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">38.652</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">393.641</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">15.281</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">1753.171</span><span class="p p-Indicator">}</span>
                <span class="nt">RCTV</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">60398.68</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">55.996</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">751.942</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">2.973</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">2573.258</span><span class="p p-Indicator">}</span>
                <span class="c1"># WSLO is the routing outlet itself. No river routing is needed</span>
                <span class="c1"># since the FlowLength is 0. Therefore, Velo and Diff are null.</span>
                <span class="nt">WSLO</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">1.026</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">119.961</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">}</span>
        <span class="nt">TRGC</span><span class="p">:</span>
                <span class="c1"># DLLO is a routing outlet. No within-subbasin routing at here (at</span>
                <span class="c1"># its own routing setting below). Namely, DLLO will be routed</span>
                <span class="c1"># first. Therefore, GShape and GScale are null.</span>
                <span class="nt">DLLO</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">11748.21</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">15.178</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">2382.476</span><span class="p p-Indicator">}</span>
                <span class="c1"># TRGC is the routing outlet itself. No river routing is needed</span>
                <span class="c1"># since the FlowLength is 0. Therefore, Velo and Diff are null.</span>
                <span class="nt">TRGC</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">3.823</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">694.564</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">}</span>
        <span class="nt">DLLO</span><span class="p">:</span>
                <span class="c1"># ResAgt is a reservoir agent. There is no within-subbasin routing.</span>
                <span class="c1"># Its release flow is the streamflow at this spot. Therefore,</span>
                <span class="c1"># GShape and GScale are null.</span>
                <span class="nt">ResAgt</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">9656.06</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">40.546</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">2250.142</span><span class="p p-Indicator">}</span>
                <span class="nt">TRTR</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">30899.40</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">50.454</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">444.699</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">27.168</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">3625.861</span><span class="p p-Indicator">}</span>
                <span class="c1"># DLLO is the routing outlet itself. No river routing is needed</span>
                <span class="c1"># since the FlowLength is 0. Therefore, Velo and Diff are null.</span>
                <span class="nt">DLLO</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">2.505</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">85.004</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">}</span>
        <span class="nt">HaggIn</span><span class="p">:</span>
                <span class="c1"># HaggIn is the routing outlet itself. No river routing is needed</span>
                <span class="c1"># since the FlowLength is 0. Therefore, Velo and Diff are null</span>
                <span class="nt">HaggIn</span><span class="p">:</span>
                        <span class="nt">Inputs</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">FlowLength</span><span class="p">:</span> <span class="nv">0</span><span class="p p-Indicator">,</span><span class="nt"> InstreamControl</span><span class="p">:</span> <span class="nv">false</span><span class="p p-Indicator">}</span>
                        <span class="nt">Pars</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">GShape</span><span class="p">:</span> <span class="nv">49.412</span><span class="p p-Indicator">,</span><span class="nt"> GScale</span><span class="p">:</span> <span class="nv">1.774</span><span class="p p-Indicator">,</span><span class="nt"> Velo</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">,</span><span class="nt"> Diff</span><span class="p">:</span> <span class="nv">null</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
<section id="abm-optional">
<h3>5. ABM (optional)<a class="headerlink" href="#abm-optional" title="Permalink to this headline"></a></h3>
<p>ABM section is a highly customized setting section. Users will assign each
active agent class to corresponding APIs.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ABM</span><span class="p">:</span>
        <span class="nt">Inputs</span><span class="p">:</span>
                <span class="c1"># Assign user-defined agent classes to corresponding APIs. Here, we</span>
                <span class="c1"># defined three agent classes in TRB_ABM_dm.py: ResDam_AgType</span>
                <span class="c1"># (reservoir), IrrDiv_AgType (diversion), and Pipe_AgType</span>
                <span class="c1"># (trans-basin conveying water).</span>
                <span class="nt">DamAgentTypes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">ResDam_AgType</span><span class="p p-Indicator">]</span>          <span class="c1"># Dam API</span>
                <span class="nt">RiverDivAgentTypes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">IrrDiv_AgType</span><span class="p p-Indicator">]</span>     <span class="c1"># RiverDiv API</span>
                <span class="nt">InsituAgentTypes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">Drain_AgType</span><span class="p p-Indicator">]</span>        <span class="c1"># InSitu API</span>
                <span class="nt">ConveyAgentTypes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">Pipe_AgType</span><span class="p p-Indicator">]</span>         <span class="c1"># Conveying API</span>
                <span class="c1"># Activate user-defined decision-making classes in TRB_ABM_dm.py.</span>
                <span class="nt">DMClasses</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">ResDM</span><span class="p p-Indicator">,</span> <span class="nv">DivDM</span><span class="p p-Indicator">,</span> <span class="nv">PipeDM</span><span class="p p-Indicator">]</span>
                <span class="c1"># User-defined ABM module, TRB_ABM_dm.py.</span>
                <span class="nt">Modules</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">TRB_ABM_dm.py</span><span class="p p-Indicator">]</span>
                <span class="c1"># Agent group is for agents make decisions and act together.</span>
                <span class="nt">AgGroup</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">Pipe_AgType</span><span class="p">:</span>
                <span class="nt">PipeAgt</span><span class="p">:</span>
                <span class="nt">Attributes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
                <span class="nt">Inputs</span><span class="p">:</span>
                        <span class="nt">Piority</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
                        <span class="nt">Links</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">TRTR</span><span class="p">:</span> <span class="nv">1</span><span class="p p-Indicator">}</span>
                        <span class="nt">DMClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PipeDM</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">ResDam_AgType</span><span class="p">:</span>
                <span class="nt">ResAgt</span><span class="p">:</span>
                <span class="nt">Attributes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
                <span class="nt">Inputs</span><span class="p">:</span>
                        <span class="nt">Piority</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
                        <span class="nt">Links</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">HaggIn</span><span class="p">:</span> <span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> ResAgt</span><span class="p">:</span> <span class="nv">1</span><span class="p p-Indicator">}</span>
                        <span class="nt">DMClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ResDM</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
        <span class="nt">IrrDiv_AgType</span><span class="p">:</span>
                <span class="nt">DivAgt</span><span class="p">:</span>
                <span class="nt">Attributes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
                <span class="nt">Inputs</span><span class="p">:</span>
                        <span class="nt">Piority</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                        <span class="nt">Links</span><span class="p">:</span>
                        <span class="nt">TRGC</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">-1</span>
                        <span class="nt">WSLO</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">ReturnFactor</span><span class="p p-Indicator">,</span> <span class="nv">0</span><span class="p p-Indicator">,</span> <span class="nv">Plus</span><span class="p p-Indicator">]</span>
                        <span class="nt">DMClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DivDM</span>
                <span class="nt">Pars</span><span class="p">:</span>
                        <span class="nt">ReturnFactor</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.12</span><span class="p p-Indicator">]</span>
                        <span class="nt">a</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.52</span>
                        <span class="nt">b</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">-0.04</span>
        <span class="nt">Drain_AgType</span><span class="p">:</span>
                <span class="nt">DrainAgt1</span><span class="p">:</span>
                <span class="nt">Attributes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
                <span class="nt">Inputs</span><span class="p">:</span>
                        <span class="nt">Piority</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                        <span class="nt">Links</span><span class="p">:</span>
                        <span class="nt">RCTV</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                        <span class="nt">DMClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
                <span class="nt">DrainAgt2</span><span class="p">:</span>
                <span class="nt">Attributes</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
                <span class="nt">Inputs</span><span class="p">:</span>
                        <span class="nt">Piority</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                        <span class="nt">Links</span><span class="p">:</span>
                        <span class="nt">WSLO</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                        <span class="nt">DMClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
                <span class="nt">Pars</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
<p>For the “Inputs” setting of ABM section, first, we assign the user-defined
agent classes (defined in ABM modules) to corresponding coupling APIs. Then,
we ativate the decision-making classes (defined in ABM modules) if any. Next,
we assign ABM module(s), where agent classes and decision-making classes are
defined. Finally, agent group is for agents make decisions and act together.
For example, two diversion agents make diversion requests together and share
the water deficiency together based on their water rights. Namely, their
diversion behaviors are not piority-based. The agent group will be defined as
a single function in a ABM module, which users can define a more detailed
interactions among agents in an agent group. See
<a class="reference internal" href="how_to_build_abm.html#how-to-build-a-abm-module"><span class="std std-ref">How to build a ABM module?</span></a> for more details.</p>
<p>Following the “Inputs” setting, we will define agent objects created by certain
agent classes (defined in ABM modules). For example, we create Barney agent
using Pipe_AgType class. Under each agent object (e.g., Barney), it has three
sub-sections: “Attributes”, “Inputs”, and “Pars.”</p>
<p><strong>a) Inputs</strong> are required information including “Piority”, “Links”, and “DMClass.”</p>
<ul class="simple">
<li><p>Piority:</p></li>
</ul>
<p>The lower value has higher piority when conflicts happen. For example, two
diverion agents divert at the same routing outlet. If users want a
non-priority-based behaviors. “AgGroup” should be applied. See
<a class="reference internal" href="how_to_build_abm.html#how-to-build-a-abm-module"><span class="std std-ref">How to build a ABM module?</span></a> for more details.</p>
<p>Note that agents coupling with Dam API has to have Piority = 0.</p>
<ul class="simple">
<li><p>Links:</p></li>
</ul>
<p>“Links” is a dictionary containing information of which outlets for agent to
take/add water from/to (e.g., {&lt;outlet&gt;: factor}). The <strong>positive</strong> factor
means add the water to that outlet. The <strong>negative</strong> number factor take water
from that outlet. The “factor” is a number in a range of [-1,1] defining the
portion of the agent’s decision to be implemented at this specific outlet. For
example, an irrigation diversion agent divert from <em>a</em> outlet but reture to <em>b</em>
and <em>c</em> outlets (i.e., subbasins) with the ratios, 0.3 and 0.7. Then, we have</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">Links</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">a</span><span class="p">:</span> <span class="nv">-1</span><span class="p p-Indicator">,</span><span class="nt"> b</span><span class="p">:</span> <span class="nv">0.3</span><span class="p p-Indicator">,</span><span class="nt"> c</span><span class="p">:</span> <span class="nv">0.7</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Assuming the diversion request is 10, the actual diversion is also 10 (i.e., no
deficiency), and return flow coefficent is 0.5, we have</p>
<div class="math notranslate nohighlight">
\[Flow_{a,new} = Flow_{a,org} + factor_a \times 10 = Flow_{a,org} -1 \times 10\]</div>
<div class="math notranslate nohighlight">
\[Flow_{return} = 0.5 \times 10 = 5\]</div>
<div class="math notranslate nohighlight">
\[Flow_{b,new} = Flow_{b,org} + factor_b \times 5 = Flow_{b,org} + 0.3 \times 5\]</div>
<div class="math notranslate nohighlight">
\[Flow_{c,new} = Flow_{c,org} + factor_c \times 5 = Flow_{c,org} + 0.7 \times 5\]</div>
<p>If the “factor” is a calibrated parameter (i.e., an unknown). We can link it to
a parameter by <em>[parameter name, its index, Plus/Minus]</em>. The parameter has to
be a list format. For example, if <em>Links = {WSLO: [ReturnFactor, 0, Plus]}</em>,
the factor will be extracted from ReturnFactor parameter (a list) at index 0.
“Plus” will tell the program that we add water to WSLO (“Minus” means divert
from the given outlet).</p>
<ul class="simple">
<li><p>DMClass:</p></li>
</ul>
<p>This is optional. If there is no specific decision-making class to be assigned,
put “null” instead. Namely, users can code everything in “agent class.” See
<a class="reference internal" href="how_to_build_abm.html#how-to-build-a-abm-module"><span class="std std-ref">How to build a ABM module?</span></a> for more details.</p>
<p><strong>b) Pars</strong> collects agents’ parameters for calibration. We
offer two types of parameter formats:</p>
<ol class="arabic simple">
<li><p>A constant (e.g., 9), or</p></li>
<li><p>A list of constants (e.g., [9, 4.5]).</p></li>
</ol>
<p><strong>c) Attributes</strong> is a space for users to store any other information for their
agents’ calculation that is not belong to “Pars” or “Inputs.”</p>
</section>
<section id="systemparseddata-auto-generated">
<h3>1. SystemParsedData (auto-generated)<a class="headerlink" href="#systemparseddata-auto-generated" title="Permalink to this headline"></a></h3>
<p>This section will be automatically generated by HydroCNHS. The model file don’t
need to include this section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="model_builder.html#model-builder"><span class="std std-ref">ModelBuilder</span></a> can help you to create an initial model
template! Check it out!</p>
</div>
</section>
</section>
<section id="abm-module-s">
<h2>ABM module(s)<a class="headerlink" href="#abm-module-s" title="Permalink to this headline"></a></h2>
<p>Agent-based model (ABM) is an user-provided human model. HydroCNHS support
multiple ABM modules to be used at a single simulation. In the ABM module,
users have 100% of freedom to design agent class (e.g., irrigation diversion
agent class, reservoir agent class, etc.); however, some input and output
protocals have to be followed. Please visit
<a class="reference internal" href="how_to_build_abm.html#how-to-build-a-abm-module"><span class="std std-ref">How to build a ABM module?</span></a> for more detailed
instructions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you only need a hydrological model and do not require any human
components, then you can skip this ABM part!</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model_builder.html" class="btn btn-neutral float-right" title="Model builder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Chung-Yi Lin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>